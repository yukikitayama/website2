<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://kit.fontawesome.com/5a2ca6d0d2.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Playfair&#43;Display:700,900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../../scss/custom.scss">
  </head>
  <body>

    <div class="container">
      <header class="blog-header py-3">
        <div class="row flex-nowrap justify-content-between align-items-center">
          <div class="col-4 pt-1">
            <!-- <a class="link-secondary" href="#">Subscribe</a> -->
          </div>
          <div class="col-4 text-center">
            <a class="blog-header-logo text-dark" href="../../index.html">Yuki Kitayama</a>
          </div>
          <div class="col-4 d-flex justify-content-end align-items-center">
            <!-- <a class="link-secondary" href="#" aria-label="Search"> -->
              <!-- <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="mx-3" role="img" viewBox="0 0 24 24"><title>Search</title><circle cx="10.5" cy="10.5" r="7.5"/><path d="M21 21l-5.2-5.2"/></svg> -->
            <!-- </a> -->
            <!-- <a class="btn btn-sm btn-outline-secondary" href="#">Sign up</a> -->
          </div>
        </div>
      </header>
    
      <div class="nav-scroller py-1 mb-2">
        <nav class="nav d-flex justify-content-between">
          <a class="p-2 link-secondary" href="../../index.html">Home</a>
          <a class="p-2 link-secondary" href="#">Google Cloud</a>
          <a class="p-2 link-secondary" href="#">AWS</a>
          <a class="p-2 link-secondary" href="#">Python</a>
          <a class="p-2 link-secondary" href="#">Data</a>
          <a class="p-2 link-secondary" href="#">Algorithm</a>
          <a class="p-2 link-secondary" href="#">Java</a>
          <a class="p-2 link-secondary" href="#">Video</a>
        </nav>
      </div>
    </div>

    <main class="container">
      <div class="row g-5">
        <div class="col-md-8">
          <article class="blog-post">
            <h2 class="blog-post-title pt-3">No password on the code with Secret Manager</h2>
            <p class="blog-post-meta">Jun 27, 2021</p>
            <hr>
            <h2>Issue</h2>
            <ul>
              <li>Some APIs require a password. As long as you run it in your local PC, you think it's okay to type it directly on the code. But when you need to upload the code to a GitHub repository or to the cloud resources, even if they are set to be private, you think is that okay?</li>
              <li>Storing the password in a separate configuration file or in environment variables, you think it's annoying to maintain.</li>
            </ul>

            <h2>Idea</h2>
            <ul>
              <li>Centrally manage your password and the other secrets in Google Cloud Secret Manager.</li>
              <li>You write a path to the secret in the cloud, which appears on the code, but the actual secret string doesn't appear.</li>
            </ul>

            <h2>Create secret in Secret Manager</h2>
            <ul>
              <li>Go to Google Cloud console, Navigation menu, Security, Secret Manager, Create secret</li>
              <li>Type a name. This name appears on the code, so it should be identifiable but not to be too long.</li>
              <li>In secret value, type password, API token, or anykind of secret string.</li>
            </ul>

            <h2>Assign permission for a service account</h2>
            <ul>
              <li>In Secret Manager console, select the secret you created, Show info panel</li>
              <li>Add a service account to member, select a role of Secret Manager, Secret Manager Secret Accessor.</li>
            </ul>

            <h2>Use the secret</h2>
            <ul>
              <li>Just for test, in your local PC, it's okay to print(secret) to confirm that secret object actually contains secret value, but you should not do that if the code will run in the cloud resources, because printed output is recorded in the cloud log.</li>
            </ul>
            <script src="https://gist-it.appspot.com/github/yukikitayama/website2/blob/main/src/py/gcp_use_secret_manager.py"></script>

            <h2>Cost</h2>
            <ul>
              <li>Assume you store one password in Secret Manager in us-central1, and you access it once a day.</li>
              <ul>
                <li>$0.06</li>
              </ul>
            </ul>
            
            <h2>Resource</h2>
            <ul>
              <li><a href="https://cloud.google.com/secret-manager/docs/reference/libraries" class="text-secondary">Secret Manager Client Libraries</a></li>
              <li><a href="https://cloud.google.com/secret-manager/pricing" class="text-secondary">Secret Manager pricing</a></li>
            </ul>
          </article>
        </div>

        <div class="col-md-4">
          <div class="position-sticky" style="top: 2rem;">
            <div class="d-flex justify-content-center mb-3">
              <img src="../../images/github_profile_picture.png" alt="Profile photo" height="200">
            </div>

            <div class="p-4 mb-3 rounded aboutBackground">
              <h4 class="fst-italic">About</h4>
              <p class="mb-0">Recently I'm very easy to forget thingsüòµ so I started recording knowledge and skill here in an accessible and open mannerüìù I hope this is useful for you tooüî• Enjoy staying here!üòÑ</p>
            </div>

            <div class="p-4">
              <h4 class="fst-italic">Elsewhere</h4>
              <a href="https://www.linkedin.com/in/yukikitayama/" target="_blank"><i class="fab fa-linkedin fa-lg" style="color: #0a66c2;"></i></a>
              <a href="https://www.youtube.com/channel/UCF5zMl6jTJaHpyxLj66FAXw" target="_blank"><i class="fab fa-youtube fa-lg" style="color: #ff0000;"></i></a>
              <a href="https://github.com/yukikitayama" target="_blank"><i class="fab fa-github fa-lg" style="color: #000000;"></i></a>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="blog-footer">
      <small>&copy; Yuki Kitayama</small>
      <p>
        <a href="#" class="stretched-link text-secondary">Back to top</a>
      </p>
    </footer>

    <script src="../../index.js"></script>
  </body>
</html>